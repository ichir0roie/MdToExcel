# Markdown To Excel Document

マークダウンをいい感じにエクセルシートに貼り付けたい｡

# flow


 1. mdToExcel
    1. mdToArray
    2. arrayToExcel


# how to

## 全体

1. mdToExcel
   1. 既存のエクセルをコピー
   2. mdをフォルダ単位でエクセル化
2. combineExcel
   1. フォルダ単位でエクセルフォルダを統合

## mdToExcel

1. dist/mdToExcel.exeを任意に場所にダウンロード
2. settings.jsonの作成
   1. 項目は" copy"の方にあるものを使用
   2. パス関連を全部フルパスで記述
   3. start系はテンプレートのどのセルを起点にするか
3. template.xlsxを作成
   1. テンプレートは適当に用意する｡マクロ付きでもOK
4. exeの実行(だいぶ古いバージョン)
   1. md側のフォルダ構成と同じように出力側のエクセルファイル群が生成される｡
   2. md以外のデータが有る場合は､そのままコピーされる｡
   3. ".git","test"がつくパスは無視される｡
5. ブックの編集
   1. フォルダ内のmdはフォルダ名のブックに統合される｡
   2. 後から追加した独自のシートは維持される｡
   3. 生成されたシートを編集しても､上書きされる｡
   4. 同じ名前のmd,xlsxがある場合
      1. 生成フォルダに有るファイルがまず消される｡
      2. 下書きフォルダのxlsx,mdをベースに再作成される｡
      3. ただし､図は消える｡

## combineExcel

指定したフォルダのサブフォルダ単位で､ブックを統合する｡

リカーシブではない｡

# mdToExcel 対応書式

## "#"
これはシート名になって､"#"毎にシートが分割される｡

## "##以降"
"#"はシートになるので､"##"が章1といった感じ｡


## "+ "

リストに対応｡現在の章と同じインデントで作成される｡

## "1. "

上に同じく｡

# md記述環境

~~vscodeで書いたmdしか動かない可能性がある｡~~設定できるようにした｡

理由は､vscodeのフォーマッタで書くと､
"+ "のインデントは半角2つ､"1. "のインデントは半角3つになる｡
それに合わせて作ってるから｡

+ これが
  + プラスのインデント
1. これは
   1. 数字のインデント…

※"\t"インデントには対応してない｡ぜひvsCodeで編集してください｡

# blueprint(very old)

+ マークダウンの読込
  + マークダウンを読み込んで､2dArrayListに構造化する｡
+ エクセルフォーマットの読込
  + ベースにするエクセルファイルを読むか作る｡
+ 新規エクセルファイルの生成
  + マークダウンデータをエクセルに書き込む
+ エクセルファイルの出力
  + 読み込んだフォルダと同じ構成でコピーして配置｡


## 既存のエクセルとマークダウンの設計書を統合したい｡
"A.md","A.xlsm"があった場合､
xlsmにmdの内容を追記する形で作成したものがコピー先のフォルダに作成されるような｡
→できなかった｡
openpyxlは開いたときに頭の情報を保持できない｡
その状態で保存すると消える｡

かわりに他のファイルもそのままコピーするようになったので､
同じ下書きフォルダで全部作成してから(名前がかぶらないように)､
実行すればきれいに出来上がる｡

図の資料は図だけ｡
文字の資料は文字だけで作れ｡


## 構造


+ root/
  + mdDocs/
  + excels/
  + mte.exe
  + readme.md


## フォーマット

### シート分け

"# name"
シート名｢name｣で作成

### 以降の章わけ

"##"→一番上の階層

### その他対応

+ "1."
+ "+ "
+ テーブル…
+ 図は流石にいいかな｡


# 実装

<https://dev.classmethod.jp/articles/python-openpyxl-2/>
openpyxlを使用すると良さげ

[OpenPyXL](https://openpyxl.readthedocs.io/en/stable/)











